---
title: 'Data Science Homework #6'
author: "P. Batten & M. de Ferrante"
date: "November 14, 2017"
output: html_document
---


```{r}
library(readr)
library(dplyr)
library(ggplot2)
library(stringr)

inspections <- 
  read_csv("../data/DOHMH_New_York_City_Restaurant_Inspection_Results.csv", 
                           col_types = cols(building = col_character()),
                           na = c("NA", "N/A")) %>%
  janitor::clean_names()

inspections <-
  inspections %>%
  filter(boro != "Missing") %>% 
  mutate(boro = str_to_title(boro))

library(scales)
library(plotly)

score_by_boro <- 
  inspections %>% 
  na.omit() %>%
    ggplot(aes(x = boro, y = score , fill = boro)) + 
    geom_boxplot(aes(group = boro)) +
    labs(title = "Boxplot of Sanitary Inspection Scores by Boro")  + 
    theme(legend.position = "none")

ggplotly(score_by_boro)


inspections$inspection_date <- as.POSIXct(inspections$inspection_date, format = "%Y-%m-%d")

scores_over_time <- 
  inspections %>%
    na.omit() %>%
    ggplot(aes(x = inspection_date, y = score)) +
      geom_hex() +
      xlab("Date") + ylab("Inspection Score") +
      ggtitle("Inspection Scores Over Time") +
      scale_x_datetime(labels = date_format("%Y-%m-%d"))

ggplotly(scores_over_time)

```


```{r}
#Change value name to readable format
inspections$cuisine_description[inspections$cuisine_description == "CafÃ©/Coffee/Tea"] <- "Coffee/Tea"


#Subset by Korean cuisine
korean_food_locations <- inspections[inspections$cuisine_description == "Korean",] %>%
  select(boro) %>%
  table() %>%
  as.data.frame()
korean_food_locations$boro <- korean_food_locations$.
korean_food_locations <- korean_food_locations[c(3,2)]
korean_food_locations$boro <- as.character(korean_food_locations$boro)
korean_food_locations[is.na(korean_food_locations)] <- 0
korean_food_locations$boro[korean_food_locations$boro == "0"] <- "Staten Island"
korean_food_locations$Freq <- as.numeric(korean_food_locations$Freq)

#Plot frequency of Korean Restaurants per Borough
korean_food_locations %>%
  ggplot(aes(x = boro, y = Freq, fill = boro)) + geom_bar(stat = "identity") + labs(title = "Number of Korean Restaurants in each NYC Borough", y = "Number of Restaurants", x = "Borough") + 
  theme(legend.position = "none")

```